# Tmux

[Tmux](https://github.com/tmux/tmux)は、端末マルチプレクサーです。複数のセッション、ウィンドウ、ペインを管理し、バックグラウンドでセッションを維持できます。

## 特徴

- 🖥️ **マルチセッション**: 複数のセッションを同時に管理
- 🪟 **ウィンドウ・ペイン**: 画面を分割して複数のプロセスを実行
- 🔄 **セッション永続化**: デタッチ・アタッチでセッションを維持
- 🔌 **プラグインシステム**: 豊富な拡張機能
- ⌨️ **カスタマイズ可能**: キーバインドやステータスバー設定

## インストール

### Homebrew（macOS/Linux）
```bash
brew install tmux
```

### その他のインストール方法
```bash
# Ubuntu/Debian
sudo apt-get install tmux

# CentOS/RHEL
sudo yum install tmux
```

## 基本操作

### セッション管理
```bash
# 新しいセッションを開始
tmux

# 名前付きセッションを開始
tmux new-session -s session_name

# セッション一覧を表示
tmux list-sessions

# セッションにアタッチ
tmux attach-session -t session_name

# セッションからデタッチ
Ctrl+a d
```

## キーバインド

### プレフィックスキー
- **プレフィックス**: `Ctrl+a` （デフォルトの`Ctrl+b`から変更）

### セッション操作
| キー | 動作 |
|------|------|
| `Ctrl+a d` | セッションをデタッチ |
| `Ctrl+a s` | セッション一覧を表示 |
| `Ctrl+a $` | セッション名を変更 |

### ウィンドウ操作
| キー | 動作 |
|------|------|
| `Ctrl+a c` | 新しいウィンドウを作成 |
| `Ctrl+a ,` | ウィンドウ名を変更 |
| `Ctrl+a n` | 次のウィンドウ |
| `Ctrl+a p` | 前のウィンドウ |
| `Ctrl+a 0-9` | 指定番号のウィンドウに移動 |
| `Ctrl+a &` | ウィンドウを閉じる |
| `Alt+Left/Right` | ウィンドウ切り替え |

### ペイン操作
| キー | 動作 |
|------|------|
| `Ctrl+a \|` | 垂直にペインを分割 |
| `Ctrl+a -` | 水平にペインを分割 |
| `Ctrl+a h/j/k/l` | ペイン間を移動（vi風） |
| `Ctrl+a H/J/K/L` | ペインをリサイズ |
| `Ctrl+a f` | ペインを最大化/最小化 |
| `Ctrl+a x` | ペインを閉じる |
| `Ctrl+a S` | ペインの同期オン/オフ |

### コピーモード
| キー | 動作 |
|------|------|
| `Ctrl+a [` | コピーモードに入る |
| `v` | 選択開始 |
| `y` | 選択内容をコピー |
| `Enter` | 選択内容をコピーして終了 |
| `q` | コピーモードを終了 |

### その他
| キー | 動作 |
|------|------|
| `Ctrl+a r` | 設定ファイルを再読み込み |
| `Ctrl+a ?` | キーバインド一覧を表示 |

## 設定内容

この設定では以下の機能が有効になっています：

### 基本設定
- プレフィックスキーを`Ctrl+a`に変更
- ウィンドウ・ペインのインデックスを1から開始
- マウスサポートを有効化
- エスケープ時間を短縮（レスポンス向上）
- ヒストリーを10,000行に拡張

### 外観設定
- 256色対応
- カスタムステータスバー（セッション名、時刻、ホスト名表示）
- アクティブペインの強調表示
- 現在のウィンドウの強調表示

### 便利機能
- ペイン分割時に現在のディレクトリを継承
- ウィンドウの自動リネーム
- アクティビティ監視
- Vi風のコピーモード

## プラグイン

[TPM (Tmux Plugin Manager)](https://github.com/tmux-plugins/tpm)を使用してプラグインを管理します。

### インストール済みプラグイン

1. **tmux-sensible**: 基本的な設定の改善
2. **tmux-resurrect**: セッションの保存・復元
3. **tmux-continuum**: 自動保存・復元（15分間隔）

### プラグイン操作
| キー | 動作 |
|------|------|
| `Ctrl+a I` | プラグインをインストール |
| `Ctrl+a U` | プラグインを更新 |
| `Ctrl+a alt+u` | プラグインをアンインストール |

### セッション復元
- **保存**: `Ctrl+a Ctrl+s`
- **復元**: `Ctrl+a Ctrl+r`
- 自動保存は15分間隔で実行

## セットアップ

1. dotfilesのインストールスクリプトを実行
```bash
./install.sh
```

2. TPM（プラグインマネージャー）をインストール
```bash
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
```

3. Tmuxを起動してプラグインをインストール
```bash
tmux
# Ctrl+a I でプラグインインストール
```

## 実用的な使用例

### 開発環境のセットアップ
```bash
# プロジェクト用セッションを作成
tmux new-session -s myproject

# エディタ用ウィンドウ
# Ctrl+a c で新しいウィンドウ作成
vim main.go

# サーバー用ペイン
# Ctrl+a | で垂直分割
go run main.go

# ログ監視用ペイン
# Ctrl+a - で水平分割
tail -f app.log
```

### セッション管理のワークフロー
```bash
# 作業開始
tmux attach-session -t myproject

# 一時的に離席
# Ctrl+a d でデタッチ

# 作業再開
tmux attach-session -t myproject
```

## トラブルシューティング

### 設定が反映されない
- 設定ファイルのパスを確認: `~/.tmux.conf`
- 設定を再読み込み: `Ctrl+a r`
- Tmuxを再起動

### プラグインが動作しない
- TPMが正しくインストールされているか確認
- プラグインのインストール: `Ctrl+a I`
- Tmuxを再起動

### 色が正しく表示されない
- ターミナルが256色をサポートしているか確認
- `TERM=screen-256color tmux` で起動を試す

### マウスが動作しない
- Tmux 2.1以降が必要
- `set -g mouse on` が設定されているか確認

## 推奨ワークフロー

1. **プロジェクトごとにセッションを作成**
2. **ウィンドウで機能を分離**（エディタ、サーバー、テストなど）
3. **ペインで関連タスクをグループ化**
4. **定期的にセッションを保存**（`Ctrl+a Ctrl+s`）
5. **tmux-continuum で自動復元を活用** 